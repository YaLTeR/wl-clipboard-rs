<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Server-side Wayland connector"><meta name="keywords" content="rust, rustlang, rust-lang, wayland_server"><title>wayland_server - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" href="../normalize.css"><link rel="stylesheet" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" href="../ayu.css" disabled><link rel="stylesheet" href="../dark.css" disabled><link rel="stylesheet" href="../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../storage.js"></script><script defer src="../crates.js"></script><script defer src="../main.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../favicon.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../wayland_server/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div></a><h2></h2></nav><nav class="sidebar"><a class="sidebar-logo" href="../wayland_server/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div></a><h2 class="location"><a href="#">Crate wayland_server</a></h2><div class="sidebar-elems"><ul class="block"><li class="version">Version 0.29.5</li><li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#modules">Modules</a></li><li><a href="#macros">Macros</a></li><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#traits">Traits</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../wheel.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1 class="fqn">Crate <a class="mod" href="#">wayland_server</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../clipboard.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../src/wayland_server/lib.rs.html#1-267">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Server-side Wayland connector</p>
<h3 id="overview"><a href="#overview">Overview</a></h3>
<p>This crate provides the interfaces and machinery to safely create servers
for the Wayland protocol. It can be used as either a rust implementatin of the protocol,
or as a wrapper around the system-wide <code>libwayland-server.so</code> if you need interoperability
with other libraries. This last case is activated by the <code>use_system_lib</code> cargo feature.</p>
<p>The Wayland protocol revolves around the creation of various objects and the exchange
of messages associated to these objects. Whenever a client connects, a <code>Display</code> object
is automatically created in their object space, which they use as a root to create new
objects and bootstrap their state.</p>
<h3 id="protocol-and-messages-handling-model"><a href="#protocol-and-messages-handling-model">Protocol and messages handling model</a></h3>
<p>The protocol being bi-directional, you can send and receive messages.
Sending messages is done via methods of Rust objects corresponding to the wayland protocol
objects, receiving and handling them is done by providing callbacks.</p>
<h4 id="resources"><a href="#resources">Resources</a></h4>
<p>The protocol and message model is very similar to the one of <code>wayland-client</code>, with the
main difference being that the underlying handles to objects are represented by the <code>Resource&lt;I&gt;</code>
type, very similarly to proxies in <code>wayland-client</code>.</p>
<p>These resources are used to send messages to the client (in the Wayland context,
these are called “events”). You usually don’t use them directly, and instead call
methods on the Rust objects themselves, which invoke the appropriate <code>Resource</code> methods.
It is also possible to directly use the <code>Resource::&lt;I&gt;::send(..)</code> method.</p>
<p>There is not a 1 to 1 mapping between Rust object instances and protocol
objects. Rather, you can think of the Rust objects as <code>Rc</code>-like handles to a
Wayland object. Multiple instances of a Rust object can exist referring to the same
protocol object.</p>
<p>Similarly, the lifetimes of the protocol objects and the Rust objects are
not tightly tied. As protocol objects are created and destroyed by protocol
messages, it can happen that an object gets destroyed while one or more
Rust objects still refer to it. In such case, these Rust objects will be disabled
and the <code>alive()</code> method on the underlying <code>Resource&lt;I&gt;</code> will start to return <code>false</code>.
Events that are subsequently sent to them are ignored.</p>
<h4 id="filters"><a href="#filters">Filters</a></h4>
<p>Your wayland objects can receive requests from the client, which need to be processed.
To do so, you can assign <code>Filter</code>s to your object. These are specially wrapped closure
so that several objects can be assigned to the same <code>Filter</code>, to ease state sharing
between the code handling different objects.</p>
<p><strong>All objects must be assigned to a filter</strong>, even if it is for doing nothing.
Failure to do will cause a <code>panic!()</code> if a request is dispatched to the faulty object.</p>
<p>A Rust object passed to your implementation is guaranteed to be alive (as it just received
a request), unless the exact message received is a destructor (which is indicated in the API
documentations).</p>
<h3 id="general-structure"><a href="#general-structure">General structure</a></h3>
<p>The core of your server is the <code>Display</code> object. It represent the ability of your program to
process Wayland messages. Once this object is created, you can configure it to listen on one
or more sockets for incoming client connections (see the <code>Display</code> docs for details).</p>
<p><code>wayland-server</code> does not include an event loop, and you are expected to drive the wayland socket
yourself using the <code>Display::flush_clients</code> and <code>Display::dispatch</code> methods. The <code>Display::get_poll_fd</code>
methods provides you with a file descriptor that can be used in a polling structure to integrate
the wayland socket in an event loop.</p>
</div></details><h2 id="modules" class="small-section-header"><a href="#modules">Modules</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="mod" href="protocol/index.html" title="wayland_server::protocol mod">protocol</a></div><div class="item-right docblock-short">Generated interfaces for the core wayland protocol</div></div><div class="item-row"><div class="item-left module-item"><a class="mod" href="sys/index.html" title="wayland_server::sys mod">sys</a></div><div class="item-right docblock-short">C-associated types</div></div></div><h2 id="macros" class="small-section-header"><a href="#macros">Macros</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="macro" href="macro.request_enum.html" title="wayland_server::request_enum macro">request_enum</a></div><div class="item-right docblock-short">Generate an enum joining several objects requests</div></div></div><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.AnonymousObject.html" title="wayland_server::AnonymousObject struct">AnonymousObject</a></div><div class="item-right docblock-short">Anonymous interface</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Client.html" title="wayland_server::Client struct">Client</a></div><div class="item-right docblock-short">A handle to a client connected to your server</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Credentials.html" title="wayland_server::Credentials struct">Credentials</a></div><div class="item-right docblock-short">Holds the client credentials the can be
retrieved from the socket with <a href="struct.Client.html#method.credentials" title="Client::credentials"><code>Client::credentials</code></a></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.DispatchData.html" title="wayland_server::DispatchData struct">DispatchData</a></div><div class="item-right docblock-short">Holder of global dispatch-related data</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Display.html" title="wayland_server::Display struct">Display</a></div><div class="item-right docblock-short">The wayland display</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Filter.html" title="wayland_server::Filter struct">Filter</a></div><div class="item-right docblock-short">An event filter</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Global.html" title="wayland_server::Global struct">Global</a></div><div class="item-right docblock-short">A handle to a global object</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Main.html" title="wayland_server::Main struct">Main</a></div><div class="item-right docblock-short">A main handle to a proxy</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Resource.html" title="wayland_server::Resource struct">Resource</a></div><div class="item-right docblock-short">An handle to a wayland resource</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.ResourceMap.html" title="wayland_server::ResourceMap struct">ResourceMap</a></div><div class="item-right docblock-short">A handle to the object map internal to the library state</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.UserDataMap.html" title="wayland_server::UserDataMap struct">UserDataMap</a></div><div class="item-right docblock-short">A storage able to store several values of <code>UserData</code>
of different types. It behaves similarly to a <code>TypeMap</code>.</div></div></div><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.NoMessage.html" title="wayland_server::NoMessage enum">NoMessage</a></div><div class="item-right docblock-short">An empty enum representing a MessageGroup with no messages</div></div></div><h2 id="traits" class="small-section-header"><a href="#traits">Traits</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.Interface.html" title="wayland_server::Interface trait">Interface</a></div><div class="item-right docblock-short">The description of a wayland interface</div></div><div class="item-row"><div class="item-left module-item"><a class="trait" href="trait.MessageGroup.html" title="wayland_server::MessageGroup trait">MessageGroup</a></div><div class="item-right docblock-short">A group of messages</div></div></div></section></div></main><div id="rustdoc-vars" data-root-path="../" data-current-crate="wayland_server" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.66.1 (90743e729 2023-01-10)" ></div></body></html>